<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Lau Journal</title>
  <link rel="stylesheet" href="../style/laujournal.css" />
  <link href="https://fonts.googleapis.com/css2?family=Quicksand&family=Dancing+Script&display=swap" rel="stylesheet">
</head>
<body>
  <div class="background-hearts"></div>
  
  <!-- Rose decorative elements -->
  <div class="rose-decoration">
    <div class="floating-rose">ğŸŒ¹</div>
    <div class="floating-rose">ğŸ’–</div>
    <div class="floating-rose">ğŸŒ¸</div>
    <div class="floating-rose">ğŸŒ¹</div>
    <div class="floating-rose">ğŸ’–</div>
    <div class="floating-rose">ğŸŒ¸</div>
  </div>
  
  <!-- Corner decorations -->
  <div class="corner-decoration top-left">ğŸ’</div>
  <div class="corner-decoration top-right">ğŸŒ¹</div>
  <div class="corner-decoration bottom-left">ğŸ’•</div>
  <div class="corner-decoration bottom-right">ğŸŒ¸</div>

  <header class="laujournal-topbar">
    <h2>Lau Journal</h2>
    <div class="header-controls">
  <button class="control-btn dashboard-btn" id="stats-btn" title="Dashboard de EstadÃ­sticas">ğŸ“Š</button>
  <button class="control-btn mosaic-btn" id="mosaic-btn" title="Vista Mosaico">ğŸ¨</button>
  <button class="control-btn today-btn" id="today-btn" title="En Este DÃ­a">ğŸ“…</button>
  <a href="journals.html" class="back-btn">â† volver</a>
    </div>
  </header>

  <section class="diary">
    <h1 class="initials-title">ğŸ’– LAU ğŸ’–</h1>

    <!-- Statistics Dashboard -->
    <div class="stats-dashboard" id="stats-dashboard" style="display: none;">
      <div class="dashboard-header">
        <h3>ğŸ“Š Dashboard de Recuerdos</h3>
        <button class="close-dashboard" id="close-stats">Ã—</button>
      </div>
      <div class="stats-grid">
        <div class="stat-card total-memories">
          <div class="stat-icon">ğŸ“¸</div>
          <div class="stat-content">
            <div class="stat-number" id="total-photos">22</div>
            <div class="stat-label">Total de Recuerdos</div>
          </div>
        </div>
        <div class="stat-card total-notes">
          <div class="stat-icon">ğŸ’­</div>
          <div class="stat-content">
            <div class="stat-number" id="total-notes">0</div>
            <div class="stat-label">Notas Escritas</div>
          </div>
        </div>
        <div class="stat-card years-active">
          <div class="stat-icon">ğŸ—“ï¸</div>
          <div class="stat-content">
            <div class="stat-number" id="years-span">2</div>
            <div class="stat-label">AÃ±os de Recuerdos</div>
          </div>
        </div>
        <div class="stat-card most-noted">
          <div class="stat-icon">â­</div>
          <div class="stat-content">
            <div class="stat-number" id="most-noted-photo">-</div>
            <div class="stat-label">Recuerdo MÃ¡s Especial</div>
          </div>
        </div>
      </div>
      <div class="charts-section">
        <div class="chart-card">
          <h4>ğŸ“ˆ Recuerdos por AÃ±o</h4>
          <div class="year-chart" id="year-chart"></div>
        </div>
        <div class="chart-card">
          <h4>ğŸ’• Lugares Favoritos</h4>
          <div class="places-chart" id="places-chart"></div>
        </div>
      </div>
      <div class="recent-activity">
        <h4>ğŸ•’ Actividad Reciente</h4>
        <div class="activity-list" id="activity-list"></div>
      </div>
    </div>

    <!-- On This Day Section -->
    <div class="on-this-day" id="on-this-day" style="display: none;">
      <div class="today-header">
        <h3>ğŸ“… En Este DÃ­a</h3>
        <button class="close-today" id="close-today">Ã—</button>
      </div>
      <div class="today-content" id="today-content">
        <!-- Will be populated by JavaScript -->
      </div>
    </div>

    <div class="timeline"></div> <!-- timeline -->

    <div class="view-controls">
      <button class="view-toggle active" data-view="grid" id="grid-view" aria-label="CuadrÃ­cula" title="CuadrÃ­cula">ğŸ”²</button>
      <button class="view-toggle" data-view="mosaic" id="mosaic-view" aria-label="Mosaico" title="Mosaico">ğŸ¨</button>
      <button class="view-toggle" data-view="presentation" id="presentation-view" aria-label="PresentaciÃ³n" title="PresentaciÃ³n">ğŸï¸</button>
    </div>

    <div class="collage-grid" id="collage-grid">
      <!-- Se llena dinÃ¡micamente con JS -->
    </div>

    <!-- Mosaic Container -->
    <div class="mosaic-container" id="mosaic-container">
      <!-- Se llena dinÃ¡micamente con JS -->
    </div>
  </section>

  <!-- Lightbox -->
  <div class="lightbox" id="lightbox">
    <span class="lightbox-close">&times;</span>
    <div class="lightbox-content">
      <img class="lightbox-img" id="lightbox-img" src="" alt="">
      <p class="lightbox-caption" id="lightbox-caption"></p>

      <!-- Memory Notes Section -->
      <div class="memory-notes-section">
        <div class="notes-header">
          <h4>ğŸ’­ Notas</h4>
          <div class="lightbox-control-group">
            <button class="action-btn favorite-star-btn" onclick="toggleFavorite(currentPhotoId)" title="Favorito" aria-label="Favorito">â˜†</button>
            <button class="action-btn download-btn" onclick="downloadPhoto(fotosLau.find(f => f.id === currentPhotoId))" title="Descargar" aria-label="Descargar">ğŸ’¾</button>
            <span class="controls-divider">|</span>
            <button class="lightbox-nav-btn" id="lightbox-prev" aria-label="Anterior" title="Anterior">âŸ¨</button>
            <button class="lightbox-nav-btn" id="lightbox-next" aria-label="Siguiente" title="Siguiente">âŸ©</button>
            <button class="add-note-btn" id="add-note-btn" aria-label="Agregar Nota" title="Agregar Nota">+</button>
          </div>
        </div>
        <div class="notes-container" id="notes-container">
          <!-- Notes will be loaded here -->
        </div>
        <div class="add-note-form" id="add-note-form" style="display: none;">
          <textarea id="note-input" placeholder="Escribe tu recuerdo, pensamiento o sentimiento sobre esta foto..."></textarea>
          <div class="note-actions">
            <button class="save-note-btn" id="save-note-btn">ğŸ’¾ Guardar</button>
            <button class="cancel-note-btn" id="cancel-note-btn">âŒ Cancelar</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Presentation Overlay -->
  <div class="presentation-overlay" id="presentation-overlay" style="display: none;">
    <div class="presentation-content">
      <img class="presentation-image" id="presentation-image" alt="">
      <div class="presentation-caption" id="presentation-caption"></div>
      <div class="presentation-controls">
        <button id="presentation-prev" class="presentation-btn" title="Anterior">âŸ¨</button>
        <button id="presentation-playpause" class="presentation-btn" title="Pausar/Reanudar">â¸</button>
        <button id="presentation-next" class="presentation-btn" title="Siguiente">âŸ©</button>
        <button id="presentation-exit" class="presentation-btn" title="Salir">âœ•</button>
      </div>
    </div>
    <audio id="presentation-audio" preload="auto" loop src="../assets/audio/rockola/EscapateConmigo.mp3"></audio>
  </div>

  <!-- Firebase Scripts -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

  <script src="../js/laujournal.js"></script>
  <nav class="laujournal-tabbar" aria-label="NavegaciÃ³n principal">
    <span class="tabbar-indicator" aria-hidden="true"></span>
    <a class="tabbar-item" href="../index.html" aria-label="Inicio" data-tab="home">
      <span class="tab-ico">ğŸ </span>
      <span class="tab-label">Inicio</span>
    </a>
    <a class="tabbar-item" href="journals.html" aria-label="Journals" data-tab="journal">
      <span class="tab-ico">ğŸ““</span>
      <span class="tab-label">Journals</span>
    </a>
    <a class="tabbar-item" href="tools.html" aria-label="Herramientas" data-tab="tools">
      <span class="tab-ico">ğŸ› </span>
      <span class="tab-label">Tools</span>
    </a>
    <a class="tabbar-item" href="rockola.html" aria-label="Rockola" data-tab="rockola">
      <span class="tab-ico">ğŸµ</span>
      <span class="tab-label">Rockola</span>
    </a>
  </nav>
  <script>
    (function(){
      const tabs=document.querySelectorAll('.laujournal-tabbar .tabbar-item');
      const indicator=document.querySelector('.laujournal-tabbar .tabbar-indicator');
      const currentFile=location.pathname.split('/').pop().toLowerCase();
      tabs.forEach(tab=>{ const href=tab.getAttribute('href'); if(!href) return; const file=href.split('/').pop().toLowerCase(); if(file===currentFile) tab.classList.add('active'); });
      function moveIndicator(target){
        const active=target||document.querySelector('.laujournal-tabbar .tabbar-item.active')||tabs[0]; if(!active||!indicator) return;
        const width=active.offsetWidth*0.55; const x=active.offsetLeft+(active.offsetWidth-width)/2;
        indicator.style.width=width+'px'; indicator.style.transform='translateX('+x+'px)';
      }
      requestAnimationFrame(()=>moveIndicator());
      tabs.forEach(t=>t.addEventListener('click', e=>moveIndicator(e.currentTarget)));
      window.addEventListener('resize', ()=>moveIndicator());
    })();
  </script>
</body>
</html>
